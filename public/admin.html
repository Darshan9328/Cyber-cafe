<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Admin - Manage Carousel</title>
    <link rel="stylesheet" href="css/style.css" />
</head>

<body>
    <div class="container">
        <h2>Manage Carousel Images</h2>
        <form id="uploadForm">
            <input type="file" id="image" name="image" required />
            <button type="submit">Upload</button>
        </form>
        <div id="imageList"></div>
    </div>

    <script>
        const backend = "https://cyber-cafe-backend-izxu.onrender.com";

        async function loadImages() {
            const res = await fetch(`${backend}/api/images`);
            const images = await res.json();
            document.getElementById("imageList").innerHTML = images.map(img => `
        <div>
          <img src="${backend}${img.url}" width="200" />
          <button onclick="deleteImage('${img.url}')">Delete</button>
        </div>`).join("");
        }

        document.getElementById("uploadForm").addEventListener("submit", async (e) => {
            e.preventDefault();
            const formData = new FormData();
            formData.append("image", document.getElementById("image").files[0]);
            await fetch(`${backend}/api/images`, { method: "POST", body: formData });
            loadImages();
        });

        async function deleteImage(url) {
            await fetch(`${backend}/api/images`, {
                method: "DELETE",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ url })
            });
            loadImages();
        }

        loadImages();
    </script>
</body>

</html>